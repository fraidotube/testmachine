import os
from fastapi import FastAPI, Request
from fastapi.responses import HTMLResponse
from fastapi.staticfiles import StaticFiles
from jinja2 import Environment, FileSystemLoader

from routes.settings import router as settings_router
from routes.sp_admin import router as sp_admin_router
from routes.wan import router as wan_router
from routes.lan import router as lan_router

app = FastAPI()
BASE_DIR = os.path.dirname(__file__)
templates = Environment(loader=FileSystemLoader(os.path.join(BASE_DIR, 'templates')))
app.mount("/static", StaticFiles(directory=os.path.join(BASE_DIR, 'static')), name="static")

@app.get("/", response_class=HTMLResponse)
def index(request: Request):
    tpl = templates.get_template('index.html')
    return tpl.render()

app.include_router(settings_router, prefix="/settings")
    app.include_router(sp_admin_router, prefix="/sp-admin")
app.include_router(wan_router, prefix="/wan")
app.include_router(lan_router, prefix="/lan")
